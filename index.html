<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>KDH Envanter KayÄ±t Sistemi</title>
    <style>
        /* Genel Stil AyarlarÄ± */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background-color: #f0f2f5; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 90vh; }
        #mainContainer { background-color: #ffffff; padding: 30px; border-radius: 10px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1); max-width: 600px; width: 95%; margin-top: 20px; }
        h1 { text-align: center; color: #007bff; font-size: 28px; margin-bottom: 20px; }
        .form-group { margin-bottom: 18px; }
        label { display: block; font-weight: 600; margin-bottom: 6px; color: #495057; font-size: 14px; }
        input[type="text"], input[type="number"], select, textarea, input[type="date"] { /* input[type="date"] eklendi */
            width: 100%; 
            padding: 10px; 
            border: 1px solid #ced4da; 
            box-sizing: border-box; 
            border-radius: 6px; 
            margin-top: 5px; 
        }
        
        /* Buton Stilleri */
        .submit-button { padding: 14px 20px; background-color: #28a745; color: white; border: none; cursor: pointer; border-radius: 6px; width: 100%; font-size: 16px; font-weight: bold; transition: background-color 0.3s, opacity 0.3s; margin-top: 20px; }
        .submit-button:hover:not(:disabled) { background-color: #218838; }
        .submit-button:disabled { background-color: #6c757d; cursor: not-allowed; opacity: 0.7; }
        .selection-button { display: block; width: 100%; padding: 15px 20px; margin-bottom: 15px; border-radius: 8px; font-size: 18px; font-weight: bold; cursor: pointer; transition: background-color 0.3s; }
        .bilgisayar-secim { background-color: #007bff; color: white; }
        .bilgisayar-secim:hover { background-color: #0056b3; }
        .yazici-secim { background-color: #ffc107; color: #343a40; }
        .yazici-secim:hover { background-color: #e0a800; }
        .back-button { background-color: #6c757d; color: white; margin-top: 10px; }
        .back-button:hover { background-color: #5a6268; }

        /* Mesaj ve DÃ¼zen */
        #sonucMesaji, .sonucMesaji { text-align: center; margin-top: 20px; font-weight: bold; font-size: 1.1em; padding: 10px; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .failure { background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .loading { background-color: #cce5ff; color: #004085; border: 1px solid #b8daff; }
        .diger-marka-input { margin-top: 10px; }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 500px) { .form-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div id="mainContainer">
        
        <div id="anaSayfa">
            <h1>KDH ENVANTER KAYIT SEÃ‡Ä°MÄ°</h1>
            <button class="selection-button bilgisayar-secim" onclick="showForm('bilgisayar')">
                ğŸ’» BÄ°LGÄ°SAYAR ENVANTERÄ° KAYDET
            </button>
            <button class="selection-button yazici-secim" onclick="showForm('yazici')">
                ğŸ–¨ï¸ YAZICI / BARKOD ENVANTERÄ° KAYDET
            </button>
        </div>

        <div id="bilgisayarFormuContainer" style="display:none;">
            <h1 id="formTitle">BÄ°LGÄ°SAYAR ENVANTER KAYIT FORMU</h1>
            <form id="bilgisayarForm">
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="bulundugu_yer">BULUNDUÄU YER * (A SÃ¼tunu)</label>
                        <input type="text" id="bulundugu_yer" name="bulundugu_yer" required placeholder="Kat/Oda NumarasÄ±">
                    </div>
                    <div class="form-group">
                        <label for="demirbas_numarasi">DEMÄ°RBAÅ NUMARASI * (E SÃ¼tunu)</label>
                        <input type="text" id="demirbas_numarasi" name="demirbas_numarasi" required placeholder="Ã–rn: E123456" maxlength="15">
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="marka">MARKA * (B SÃ¼tunu)</label>
                        <select id="marka" name="marka" required onchange="checkOtherBrand(this.value)">
                            <option value="">LÃ¼tfen SeÃ§iniz</option>
                            <option value="DELL">DELL</option>
                            <option value="HP">HP</option>
                            <option value="TECHNOPC">TECHNOPC</option>
                            <option value="ACER">ACER</option>
                            <option value="FUJÄ°TSU">FUJÄ°TSU</option>
                            <option value="LENOVO">LENOVO</option>
                            <option value="DÄ°ÄER">DÄ°ÄER</option>
                        </select>
                        <input type="text" id="marka_diger" name="marka_diger" class="diger-marka-input" placeholder="LÃ¼tfen MarkayÄ± Belirtiniz" style="display: none;">
                    </div>
                    <div class="form-group">
                        <label for="model">MODEL * (C SÃ¼tunu)</label>
                        <input type="text" id="model" name="model" required placeholder="Ã–rn: OptiPlex 3080">
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="seri">SERÄ° NO (D SÃ¼tunu)</label>
                        <input type="text" id="seri" name="seri" placeholder="Seri NumarasÄ±">
                    </div>
                    <div class="form-group">
                        <label for="isletim_sistemi">Ä°ÅLETÄ°M SÄ°STEMÄ° (F SÃ¼tunu)</label>
                        <select id="isletim_sistemi" name="isletim_sistemi" required>
                            <option value="">LÃ¼tfen SeÃ§iniz</option>
                            <option value="WÄ°N 11">WÄ°N 11</option>
                            <option value="WÄ°N 10">WÄ°N 10</option>
                            <option value="WÄ°N 8">WÄ°N 8</option>
                            <option value="WÄ°N 7">WÄ°N 7</option>
                            <option value="DÄ°ÄER/YOK">DÄ°ÄER/YOK</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="islemci">Ä°ÅLEMÃ‡Ä° (G SÃ¼tunu)</label>
                        <input type="text" id="islemci" name="islemci" placeholder="Ã–rn: i5-10. Nesil">
                    </div>
                    <div class="form-group">
                        <label for="ek_aksamlar">EK AKSAMLAR (H SÃ¼tunu)</label>
                        <input type="text" id="ek_aksamlar" name="ek_aksamlar" placeholder="Ã–rn: MonitÃ¶r, Klavye, Mouse">
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="alinma_tarihi">ALINMA TARÄ°HÄ° (I SÃ¼tunu)</label>
                        <input type="date" id="alinma_tarihi" name="alinma_tarihi">
                    </div>
                    <div class="form-group">
                        <label for="garanti">GARANTÄ° (J SÃ¼tunu)</label>
                        <input type="text" id="garanti" name="garanti" placeholder="Ã–rn: Var, 2026/05">
                    </div>
                </div>

                <div class="form-grid">
                    <div class="form-group">
                        <label for="ram">RAM (K SÃ¼tunu)</label>
                        <input type="text" id="ram" name="ram" placeholder="Ã–rn: 8GB">
                    </div>
                    <div class="form-group">
                        <label for="ip">IP ADRESÄ° (L SÃ¼tunu)</label>
                        <input type="text" id="ip" name="ip" placeholder="Ã–rn: 192.168.1.10">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="aciklama">AÃ‡IKLAMA (N SÃ¼tunu - Maks. 160 Karakter)</label>
                    <textarea id="aciklama" name="aciklama" rows="3" placeholder="Ã–nemli notlar, gÃ¼ncellemeler, arÄ±zalar." maxlength="160"></textarea>
                </div>
                
                <button type="submit" class="submit-button" id="bilgisayarSubmitButton">BÄ°LGÄ°SAYAR ENVANTERÄ°NÄ° KAYDET</button>
                <button type="button" class="selection-button back-button" onclick="showForm('ana')">GERÄ° DÃ–N</button>
                <p style="text-align: center; font-size: 0.9em; color: #888; margin-top: 10px;">* KayÄ±t Tarihi (M SÃ¼tunu) otomatik doldurulacaktÄ±r.</p>

            </form>
            <p id="bilgisayarSonucMesaji" class="sonucMesaji"></p>
        </div>

        <div id="yaziciFormuContainer" style="display:none;">
            <h1>KDH YAZICI ENVANTER KAYDI</h1>
            <form id="yaziciForm">
                <div class="form-group">
                    <label for="alt_cihaz_turu">CÄ°HAZ TÃœRÃœ * (A SÃ¼tunu)</label>
                    <select id="alt_cihaz_turu" name="alt_cihaz_turu" required>
                        <option value="">LÃ¼tfen SeÃ§iniz</option>
                        <option value="YazÄ±cÄ±">YazÄ±cÄ±</option>
                        <option value="Barkod CihazÄ±">Barkod CihazÄ±</option>
                        <option value="DiÄŸer">DiÄŸer</option>
                    </select>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="yazici_seri_no">SERÄ° NO * (B SÃ¼tunu)</label>
                        <input type="text" id="yazici_seri_no" name="yazici_seri_no" required placeholder="CihazÄ±n Seri NumarasÄ±" maxlength="30">
                    </div>
                    <div class="form-group">
                        <label for="yazici_bulundugu_yer">BULUNDUÄU YER * (C SÃ¼tunu)</label>
                        <input type="text" id="yazici_bulundugu_yer" name="yazici_bulundugu_yer" required placeholder="Kat/Oda NumarasÄ±">
                    </div>
                </div>
                
                <div class="form-grid">
                    <div class="form-group">
                        <label for="yazici_marka">MARKA * (D SÃ¼tunu)</label>
                        <input type="text" id="yazici_marka" name="yazici_marka" required placeholder="Ã–rn: HP, Canon, Zebra">
                    </div>
                    <div class="form-group">
                        <label for="yazici_model">MODEL * (E SÃ¼tunu)</label>
                        <input type="text" id="yazici_model" name="yazici_model" required placeholder="Ã–rn: LaserJet Pro M102a">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="yazici_aciklama">AÃ‡IKLAMA (F SÃ¼tunu - Maks. 160 Karakter)</label>
                    <textarea id="yazici_aciklama" name="yazici_aciklama" rows="3" placeholder="Ã–nemli notlar, durum gÃ¼ncellemeleri, arÄ±zalar." maxlength="160"></textarea>
                </div>
                
                <button type="submit" class="submit-button" id="yaziciSubmitButton">YAZICI ENVANTERÄ°NÄ° KAYDET</button>
                <button type="button" class="selection-button back-button" onclick="showForm('ana')">GERÄ° DÃ–N</button>
                <p style="text-align: center; font-size: 0.9em; color: #888; margin-top: 10px;">* Tarih (H SÃ¼tunu) otomatik doldurulacaktÄ±r.</p>

            </form>
            <p id="yaziciSonucMesaji" class="sonucMesaji"></p>
        </div>
        
    </div>

    <script>
        // =============================================
        // APPS SCRIPT URL'LERÄ°
        // =============================================
        // ğŸš¨ Bu URL'leri kendi yayÄ±nlanmÄ±ÅŸ Apps Script Web UygulamasÄ± URL'leriniz ile DEÄÄ°ÅTÄ°RÄ°N!
        const BILGISAYAR_DGS_URL = "https://script.google.com/macros/s/AKfycbwOOUSX48j-62MsDpdxuOmTHcQxAYzuFAgPfsf0D7GCJablwbQcyy72XPPEPqVStcOA/exec"; 
        const YAZICI_DGS_URL = "https://script.google.com/macros/s/AKfycbxsh52Y5s8G0oPlgJeXbXpCSVxYZp2Mi36DJpxACp7xPVeofJLV_vCQ0BVWuVzdi5Bn/exec"; 
        
        // =============================================
        // SAYFA YÃ–NETÄ°MÄ°
        // =============================================
        function showForm(formType) {
            document.getElementById('anaSayfa').style.display = 'none';
            document.getElementById('bilgisayarFormuContainer').style.display = 'none';
            document.getElementById('yaziciFormuContainer').style.display = 'none';

            if (formType === 'bilgisayar') {
                document.getElementById('bilgisayarFormuContainer').style.display = 'block';
            } else if (formType === 'yazici') {
                document.getElementById('yaziciFormuContainer').style.display = 'block';
            } else { // 'ana' veya varsayÄ±lan
                document.getElementById('anaSayfa').style.display = 'block';
            }
            // Sayfa deÄŸiÅŸiminde sonucu sÄ±fÄ±rla
            document.querySelectorAll('.sonucMesaji').forEach(el => {
                el.textContent = '';
                el.className = 'sonucMesaji';
            });
        }
        
        // Ä°lk yÃ¼klemede Ana SayfayÄ± gÃ¶ster
        showForm('ana'); 

        // =============================================
        // BÄ°LGÄ°SAYAR FORM Ä°ÅLEMLERÄ°
        // =============================================
        function checkOtherBrand(value) {
            const digerInput = document.getElementById('marka_diger');
            digerInput.style.display = (value === 'DÄ°ÄER') ? 'block' : 'none';
            digerInput.required = (value === 'DÄ°ÄER');
            if (value !== 'DÄ°ÄER') {
                digerInput.value = ''; 
            }
        }

        document.getElementById('bilgisayarForm').addEventListener('submit', async function(e) {
            e.preventDefault(); 
            const form = e.target;
            const submitButton = document.getElementById('bilgisayarSubmitButton');
            const sonucMesaji = document.getElementById('bilgisayarSonucMesaji');
            const formData = new FormData(form);

            // Ã–zel 'DiÄŸer Marka' kontrolÃ¼ ve genel zorunlu alan kontrolÃ¼
            if(!form.checkValidity() || (formData.get('marka') === 'DÄ°ÄER' && !formData.get('marka_diger'))) {
                sonucMesaji.textContent = "âŒ LÃ¼tfen tÃ¼m yÄ±ldÄ±zlÄ± alanlarÄ± doldurunuz veya 'DiÄŸer' marka adÄ±nÄ± belirtiniz.";
                sonucMesaji.className = 'failure sonucMesaji';
                return;
            }

            submitButton.disabled = true;
            sonucMesaji.textContent = "âš™ï¸ KayÄ±t verileri sunucuya gÃ¶nderiliyor...";
            sonucMesaji.className = 'loading sonucMesaji';

            try {
                const response = await fetch(BILGISAYAR_DGS_URL, {
                    method: 'POST',
                    body: formData,
                    mode: 'no-cors' 
                });
                
                // no-cors modu nedeniyle yanÄ±tÄ± detaylÄ± kontrol edemiyoruz, baÅŸarÄ±lÄ± kabul et
                sonucMesaji.textContent = "âœ… BÄ°LGÄ°SAYAR KAYDI BaÅŸarÄ±yla TamamlandÄ±! (Sheets dosyanÄ±zÄ± kontrol ediniz)";
                sonucMesaji.className = 'success sonucMesaji';
                
                form.reset(); 
                checkOtherBrand(''); 

            } catch (error) {
                sonucMesaji.textContent = `âŒ KRÄ°TÄ°K HATA: BaÄŸlantÄ± kurulamadÄ±. URL'yi kontrol edin.`;
                sonucMesaji.className = 'failure sonucMesaji';
                console.error('Kritik Hata:', error);
            } finally {
                submitButton.disabled = false;
            }
        });

        // =============================================
        // YAZICI FORM Ä°ÅLEMLERÄ°
        // =============================================
        document.getElementById('yaziciForm').addEventListener('submit', async function(e) {
            e.preventDefault(); 
            const form = e.target;
            const submitButton = document.getElementById('yaziciSubmitButton');
            const sonucMesaji = document.getElementById('yaziciSonucMesaji');
            const formData = new FormData(form);

            if(!form.checkValidity()) {
                sonucMesaji.textContent = "âŒ LÃ¼tfen tÃ¼m yÄ±ldÄ±zlÄ± (*) alanlarÄ± doldurunuz.";
                sonucMesaji.className = 'failure sonucMesaji';
                return;
            }

            submitButton.disabled = true;
            submitButton.textContent = 'Kaydediliyor...';
            sonucMesaji.textContent = "âš™ï¸ Verileriniz sunucuya gÃ¶nderiliyor...";
            sonucMesaji.className = 'loading sonucMesaji';

            try {
                const response = await fetch(YAZICI_DGS_URL, {
                    method: 'POST',
                    body: formData,
                });
                
                const text = await response.text();
                let data;
                
                try {
                    data = JSON.parse(text);
                } catch (e) { 
                    data = { result: 'success' };
                }

                if (data.result === 'error') {
                    sonucMesaji.textContent = `âŒ YAZICI KAYDI BaÅŸarÄ±sÄ±z: ${data.message}`;
                    sonucMesaji.className = 'failure sonucMesaji';
                } else {
                    sonucMesaji.textContent = "âœ… YAZICI KAYDI BaÅŸarÄ±yla TamamlandÄ±! (Sheets dosyanÄ±zÄ± kontrol ediniz)";
                    sonucMesaji.className = 'success sonucMesaji';
                    form.reset(); 
                }
            } catch (error) {
                sonucMesaji.textContent = "âŒ GÃ¶nderim sÄ±rasÄ±nda bir hata oluÅŸtu. (URL'yi kontrol edin)";
                sonucMesaji.className = 'failure sonucMesaji';
                console.error('Hata:', error);
            } finally {
                submitButton.disabled = false;
                submitButton.textContent = 'YAZICI ENVANTERÄ°NÄ° KAYDET';
            }
        });
    </script>

</body>
</html>
